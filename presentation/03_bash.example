#!/usr/bin/env bash

function validate() {
    content=$1

    if [ -z "${content}" ]; then
        echo "Some validation failed"
        exit 1
    else
        echo "$(get_post ${content})"
        exit 0
    fi
}

function publish_or_schedule() {
    post=$1

    url="$(get_url ${post})"

    if [ $shell_magic() ]; then
        schedule_date="$(get_schedule ${post})"
    fi
}

function post() {
    content=$1

    local post
    post="$(validate ${content})"

    if [ $? -eq 0 ]; then
        publish_or_schedule ${post}

        if [ -z "${schedule_date}" ]; then
            echo "Published now: ${post} - ${url}"
        else
            echo "Scheduled: ${post} - ${url} @ ${schedule_date}"
        fi
    else
        echo "Failed validation"
        exit 1
    fi
}

function get_post() {
    echo $1
}

function get_schedule() {
    echo ""
}

function get_url() {
    echo "https://www.example.com/$1"
}

function shell_magic() {
    exit 0
}

post $1
